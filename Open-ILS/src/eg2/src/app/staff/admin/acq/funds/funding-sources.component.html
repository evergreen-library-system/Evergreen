<ng-template #successStrTmpl i18n>{{idlClassDef.label}} Update Succeeded</ng-template>
<eg-string #successString [template]="successStrTmpl"></eg-string>

<ng-template #updateFailedStrTmpl i18n>Update of {{idlClassDef.label}} failed</ng-template>
<eg-string #updateFailedString [template]="updateFailedStrTmpl"></eg-string>

<ng-template #deleteFailedStrTmpl i18n>Delete of {{idlClassDef.label}} failed or was not allowed</ng-template>
<eg-string #deleteFailedString [template]="deleteFailedStrTmpl"></eg-string>

<ng-template #deleteSuccessStrTmpl i18n>{{idlClassDef.label}} Successfully Deleted</ng-template>
<eg-string #deleteSuccessString [template]="deleteSuccessStrTmpl"></eg-string>

<ng-template #createStrTmpl i18n>{{idlClassDef.label}} Successfully Created</ng-template>
<eg-string #createString [template]="createStrTmpl"></eg-string>

<ng-template #createErrStrTmpl i18n>Failed to create new {{idlClassDef.label}}</ng-template>
<eg-string #createErrString [template]="createErrStrTmpl"></eg-string>

<ng-container *ngIf="orgField">
  <div class="row">
    <div class="col-lg-6">
      <ng-container *ngIf="orgField">
        <eg-org-family-select
          ariaLabel="Org Unit" i18n-ariaLabel
          [limitPerms]="viewPerms" 
          [selectedOrgId]="contextOrg.id()"
          [(ngModel)]="searchOrgs"
          (ngModelChange)="grid.reload()">
        </eg-org-family-select>
      </ng-container>
    </div>
  </div>
  <hr/>
</ng-container>

<!-- idlObject and fieldName applied programmatically -->
<eg-translate #translator></eg-translate>

<ng-container *ngIf="helpTemplate">
  <ng-container *ngTemplateOutlet="helpTemplate"></ng-container>
</ng-container>

<ng-template #configFieldLink let-row="row" let-col="col">
  <a i18n-title title="Link To {{col.label}}"
    [attr.href]="configFieldLinkUrl(row, col)">{{configLinkLabel(row, col)}}</a>
</ng-template>

<eg-grid #grid idlClass="{{idlClass}}" [dataSource]="dataSource" hideFields="{{hideGridFields}}"
    [sortable]="true" persistKey="{{persistKey}}" autoGeneratedColumnOrder="{{fieldOrder}}"
    [filterable]="true" [stickyHeader]="true"
    (onRowActivate)="editSelected([$event])"
    [cellTextGenerator]="cellTextGenerator">
  <eg-grid-toolbar-button [disabled]="!canCreate" 
    label="New {{idlClassDef.label}}" i18n-label (onClick)="createNew()">
  </eg-grid-toolbar-button>
  <eg-grid-toolbar-action label="Edit Selected" i18n-label (onClick)="editSelected($event)"
    group="Selected" i18n-group [disableOnRows]="notOneSelectedRow">
  </eg-grid-toolbar-action>
  <eg-grid-toolbar-action label="Delete Selected" i18n-label (onClick)="deleteSelected($event)"
    group="Selected" i18n-group [disableOnRows]="notOneSelectedRow">
  </eg-grid-toolbar-action>
  <eg-grid-toolbar-action label="Apply Credit" i18n-label (onClick)="createCredit($event)"
    group="Credits" i18n-group [disableOnRows]="notOneSelectedActiveRow">
  </eg-grid-toolbar-action>
  <eg-grid-toolbar-action label="Allocate to Fund" i18n-label (onClick)="allocateToFund($event)"
    group="Allocations" i18n-group [disableOnRows]="notOneSelectedActiveRow">
  </eg-grid-toolbar-action>
  <eg-grid-toolbar-action label="View Credits" i18n-label (onClick)="openTransactionsDialog($event, 'credits')"
    group="Credits" i18n-groups [disableOnRows]="notOneSelectedRow">
  </eg-grid-toolbar-action>
  <eg-grid-toolbar-action label="View Allocations" i18n-label (onClick)="openTransactionsDialog($event, 'allocations')"
    group="Allocations" i18n-group [disableOnRows]="notOneSelectedRow">
  </eg-grid-toolbar-action>

  <ng-template #nameTmpl let-row="row">
    <a href="" (click)="openTransactionsDialog([row], 'credits'); false">
      {{row.name()}}
    </a>
  </ng-template>
  <eg-grid-column path="name" [cellTemplate]="nameTmpl"></eg-grid-column>
  <eg-grid-column path="owner"></eg-grid-column>
  <eg-grid-column path="code"></eg-grid-column>
  <eg-grid-column path="currency_type"></eg-grid-column>
  <eg-grid-column path="active" [initialFilterValue]="'t'"></eg-grid-column>
  <eg-grid-column path="balance" datatype="money" [filterable]="false" [sortable]="false"
    i18n-label label="Balance"></eg-grid-column>
  <eg-grid-column path="total_credits" datatype="money" [filterable]="false" [sortable]="false"
    i18n-label label="Total Credits"></eg-grid-column>
  <eg-grid-column path="total_allocations" datatype="money" [filterable]="false" [sortable]="false"
    i18n-label label="Total Allocations"></eg-grid-column>
  <eg-grid-column path="id" [hidden]="true"></eg-grid-column>


</eg-grid>

<eg-fm-record-editor #editDialog idlClass="{{idlClass}}" 
    [fieldOptions]="fieldOptions"
    [fieldOrder]="fieldOrder"
    [defaultNewRecord]="defaultNewRecord"
    [preloadLinkedValues]="true"
    [readonlyFields]="readonlyFields">
</eg-fm-record-editor>

<eg-funding-source-transactions-dialog #fundingSourceTransactionsDialog></eg-funding-source-transactions-dialog>

<eg-confirm-dialog #confirmDel
  dialogTitle="Delete?" i18n-dialogTitle
  dialogBody="Delete funding source?" i18n-dialogBody>
</eg-confirm-dialog>
<eg-alert-dialog #alertDialog
 i18n-dialogBody
  dialogBody="Funding source cannot deleted as it is in use">
</eg-alert-dialog>


<eg-fm-record-editor #applyCreditDialog idlClass="acqfscred">
</eg-fm-record-editor>
<eg-fm-record-editor #allocateToFundDialog idlClass="acqfa"
  [fieldOptions]="{fund:{linkedSearchConditions:{'active':'t'},preloadLinkedValues:true}}">
</eg-fm-record-editor>
